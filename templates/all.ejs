<!DOCTYPE html>
<html lang="en">

<head>
    <title></title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <title>Liks</title>
</head>

<body class="container mt-5 bg-dark text-light">

    <h1 class="">Links</h1>
    <a href="/add">Adcionar um link</a>

    <%for(const link of links){%>
        <div id="<%=link.id%>" class="mt-4">
            <h3>
                <%=link.title%>
            </h3>
            <p>
                <%=link.description%>
            </p>
            <div class="d-flex flex-column">
                <a href="/<%=link.url%>">Direct Link</a>
                <a href="/edit/<%=link.id%>" class="mt-2">Edit</a>
                <h4>Views(route): <%=link.views%></h4>

            </div>
            <button class="btn btn-danger text-light mt-2" type="" onclick="deleteLink('<%=link.id%>')">Delete</button>

        </div>
        <%}%>
            <script>
                function deleteLink(id) {
                    fetch("/" + id, {method: 'DELETE'}).then(res => {
                        if (res.status == 200) {
                            res.text().then(linkId => {
                                document.getElementById(linkId).remove();
                            })
                        } else {
                            res.json().then(err => {
                                alert(err.message);
                            })
                        }
                    })
                }

            </script>
</body>


</html>
